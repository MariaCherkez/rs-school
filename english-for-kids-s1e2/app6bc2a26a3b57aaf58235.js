(()=>{"use strict";var e={225:(e,t,i)=>{i.r(t)},76:(e,t,i)=>{i.r(t)},278:(e,t,i)=>{i.r(t)},850:(e,t,i)=>{i.r(t)},528:(e,t,i)=>{i.r(t)},57:(e,t,i)=>{i.r(t)},667:(e,t,i)=>{i.r(t)},693:(e,t,i)=>{i.r(t)},371:(e,t,i)=>{i.r(t)},642:(e,t,i)=>{i.r(t)},948:(e,t,i)=>{i.r(t)},503:(e,t,i)=>{i.r(t)},373:(e,t,i)=>{i.r(t)},891:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.Events=void 0,(i=t.Events||(t.Events={})).click="click",i.hashchange="hashchange",i.pause="pause",i.play="play",i.mouseup="mouseup"},380:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0,t.Game=class{constructor(e){this.score=document.createElement("div"),this.score.classList.add("score-container"),this.score.innerHTML="<div class='score'></div>",this.button=document.createElement("div"),this.button.classList.add("button-start"),this.button.textContent="Start",this.audio=[],this.errors=0,this.user="user",this.indexAudio=0,e.forEach((e=>this.audio.push(e.cardDatabase.audio))),this.audio.sort((()=>Math.random()-.5))}setRepeatButton(){this.button.textContent="",this.button.classList.add("button-repeat")}addStar(e){var t;const i=document.createElement("div");i.classList.add("star"),e||i.classList.add("star-error"),null===(t=this.score.querySelector(".score"))||void 0===t||t.append(i)}getCurrentAudio(){return this.audio[this.indexAudio]}}},794:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.isRoute=t.Route=void 0,function(e){e.main="",e.cards="cards",e.statistics="statistics",e.admin="admin"}(i=t.Route||(t.Route={})),t.isRoute=function(e){return void 0!==Object.values(i).find((t=>t===e))}},732:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatisticsData=void 0,t.StatisticsData=class{constructor(e,t,i,s,n,a,r){this.idCard=e,this.categoryName=t,this.word=i,this.translate=s,this.train=n,this.correct=a,this.error=r}}},952:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.C=void 0;const i={DATABASE_NAME:"MariaCherkez",DATABASE_VERSION:1,DATABASE_STORE_NAME:"words",DIFFICULT_CATEGORY:"difficult",CLASS_CARD_TOOGLE:"card__toggle",NO_CLOSE_POPUP_ELEMENTS:["aside-open","login-button","popup-button","menu","menu__burger"],SERVER_URL:"http://127.0.0.1:3000"};t.C=i,Object.freeze(i)},505:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPercent=t.compare=t.delay=void 0,t.delay=function(e){return new Promise((t=>{setTimeout(t,e)}))},t.compare=function(e,t){return e>t?1:e<t?-1:0},t.getPercent=function(e){let t=100*e.error/(e.error+e.correct);return Number.isNaN(t)&&(t=0),t}},752:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function r(e){try{d(s.next(e))}catch(e){a(e)}}function o(e){try{d(s.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const n=i(891),a=i(794),r=i(952),o=i(0),d=i(977),c=i(583),l=i(53),h=i(695);t.App=class{constructor(){if(this.bodyElement=Array.from(document.getElementsByTagName("body")).shift(),!this.bodyElement)throw Error("App body element not found");this.isAdmin=!1,this.header=new d.Header(!1),this.main=new c.Main,this.sidebar=new h.Sidebar,this.popup=new l.Popup,this.footer=new o.Footer,this.addListeners(),this.bodyElement.append(this.header.element,this.main.element,this.sidebar.element,this.popup.element,this.footer.element)}entryPage(){window.history.pushState(null,"",`#${a.Route.main}`),this.main.setCurrentPage(a.Route.main)}addListeners(){var e;return s(this,void 0,void 0,(function*(){window.addEventListener(n.Events.hashchange,this.hashChangeListener.bind(this)),null===(e=this.bodyElement)||void 0===e||e.addEventListener(n.Events.mouseup,this.closeSidebarListener.bind(this)),this.header.getMenu().addEventListener(n.Events.click,this.menuClickListener.bind(this)),this.header.getModeButton().addEventListener(n.Events.click,this.toogleModeListener.bind(this)),this.addAdminListener(),yield this.sidebar.addLinks(),this.sidebar.getLinks().forEach((e=>{e.onclick=this.sideBarListener.bind(this)})),this.popup.getSubmit().addEventListener(n.Events.click,this.popupSubmitListener.bind(this))}))}addAdminListener(){const e=this.sidebar.getLoginButton();e instanceof HTMLElement&&(this.isAdmin?e.onclick=()=>{this.sidebar.closeSidebar(),window.history.pushState(null,"",`#${a.Route.admin}`),window.dispatchEvent(new Event(n.Events.hashchange))}:e.onclick=()=>this.popup.openPopup())}hashChangeListener(){return s(this,void 0,void 0,(function*(){const e=window.location.hash.slice(1);a.isRoute(e)?(e===a.Route.admin?(this.header.update(!0),this.header.getLogOut().addEventListener(n.Events.click,this.logOutListener.bind(this)),this.header.getLinkCategories().addEventListener(n.Events.click,this.linkCategoriesListener.bind(this))):(this.header.update(!1),this.header.getMenu().addEventListener(n.Events.click,this.menuClickListener.bind(this)),this.header.getModeButton().addEventListener(n.Events.click,this.toogleModeListener.bind(this))),yield this.main.setCurrentPage(e),this.main.currentCategory!==r.C.DIFFICULT_CATEGORY&&this.sidebar.setCurrent(e,this.main.currentCategory)):(this.header.update(!1),this.header.getMenu().addEventListener(n.Events.click,this.menuClickListener.bind(this)),this.header.getModeButton().addEventListener(n.Events.click,this.toogleModeListener.bind(this)),yield this.entryPage(),this.sidebar.setCurrent(a.Route.main,this.main.currentCategory)),this.addAdminListener()}))}menuClickListener(){this.header.toogleMenu(),this.sidebar.toggleSidebar()}closeSidebarListener(e){if(e.target instanceof HTMLElement){for(let t=0;t<r.C.NO_CLOSE_POPUP_ELEMENTS.length;t++)if(e.target.classList.contains(r.C.NO_CLOSE_POPUP_ELEMENTS[t]))return;this.header.setOpenMenu(),this.sidebar.closeSidebar()}}sideBarListener(e){e.target instanceof HTMLElement&&e.target.dataset.cat&&(this.main.currentCategory=e.target.dataset.cat,this.main.setCurrentPage(a.Route.cards),this.sidebar.setCurrent(window.location.hash.slice(1),this.main.currentCategory))}toogleModeListener(){this.header.toogleMode(),this.main.toogleMode(),this.sidebar.toogleMode()}popupSubmitListener(e){e.preventDefault(),this.popup.checkFields()?(this.isAdmin=!0,this.sidebar.getLoginButton().innerHTML="Admin panel",window.history.pushState(null,"",`#${a.Route.admin}`),window.dispatchEvent(new Event(n.Events.hashchange)),this.popup.closePopup()):this.popup.highlight()}logOutListener(){this.isAdmin=!1,this.sidebar.getLoginButton().innerHTML="Login",window.history.pushState(null,"",`#${a.Route.main}`),window.dispatchEvent(new Event(n.Events.hashchange))}linkCategoriesListener(){this.main.adminCategory(),this.header.setSelect(this.main.adminPage.currentCategory)}linkWordsListener(){this.header.setSelect(this.main.adminPage.currentCategory)}}},598:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function r(e){try{d(s.next(e))}catch(e){a(e)}}function o(e){try{d(s.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AdminPage=void 0;const n=i(891),a=i(259),r=i(155),o=i(465);i(225),t.AdminPage=class{constructor(){this.categories=[],this.cards=[],this.element=document.createElement("div"),this.element.classList.add("admin-flex"),this.currentCategory="",this.categories=[],this.cards=[],this.addCategory=document.createElement("div"),this.addCategory.classList.add("admin-card","admin-card-category"),this.addCategory.innerHTML='  \n      <p class="admin-card__title">Create new Category</p>\n      <div class="admin-card__add"></div> ',this.addWord=document.createElement("div"),this.addWord.classList.add("admin-card","admin-card-word"),this.addWord.innerHTML='\n      <p class="admin-card__title">Add new word</p>\n      <div class="admin-card__add"></div>',this.setCurrentPage()}setCurrentPage(){return s(this,void 0,void 0,(function*(){this.currentCategory?yield this.addCards():(yield this.addCategories(),this.categories.forEach((e=>{e.getRemove().addEventListener(n.Events.click,(()=>this.removeCatListener(e))),e.getUpdate().addEventListener(n.Events.click,(()=>this.updateCatListener(e))),e.getWords().addEventListener(n.Events.click,(()=>this.wordsCatListener(e)))})))}))}addCategories(){return s(this,void 0,void 0,(function*(){this.categories=[];try{const e=yield a.getCategories();if(e.ok){const t=yield e.json(),i=yield a.getCards();if(i.ok){const e=yield i.json();t.forEach((t=>{const i=e.filter((e=>e.categoryId.toString()===t._id)).length;this.categories.push(new o.CategoryAdmin(t,i))}))}}}catch(e){console.log(e)}finally{this.element.innerHTML="",this.categories.forEach((e=>this.element.append(e.element))),this.element.append(this.addCategory)}}))}addCards(){return s(this,void 0,void 0,(function*(){let e;this.cards=[];try{const t=yield a.getCardsByCategory(this.currentCategory);t.ok&&(e=yield t.json(),this.cards=e.map((e=>new r.CardAdmin(e))))}catch(e){console.log(e)}finally{this.element.innerHTML="",this.cards.forEach((e=>this.element.append(e.element))),this.element.append(this.addWord)}}))}removeCatListener(e){return s(this,void 0,void 0,(function*(){const t=this.categories.findIndex((t=>t.category._id===e.category._id));yield a.deleteCategory(e.category._id),yield a.deleteCardsByCategory(e.category._id),this.categories.splice(t,1),this.element.innerHTML="",this.categories.forEach((e=>this.element.append(e.element))),this.element.append(this.addCategory)}))}updateCatListener(e){console.log(this.element)}wordsCatListener(e){this.currentCategory=e.category._id,this.setCurrentPage()}}},155:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardAdmin=void 0;const s=i(952);t.CardAdmin=class{constructor(e){this.cardDatabase=e,this.element=document.createElement("div"),this.element.classList.add("admin-card","admin-card-word"),this.element.innerHTML=`\n    <div class="about-word">\n      <div class="admin-card__remove"></div>\n      <p><span>Word:</span> ${e.word}</p>\n      <p><span>Translation:</span> ${e.translate}</p>\n      <p><span>Sound file:</span> ${e.audio}</p>\n      <p><span>Image:</span></p>\n      <div class="about-word__image" style="background-image: url('${s.C.SERVER_URL}${this.cardDatabase.image}');"></div>\n      <div class="admin-card__button-container">\n        <button>Change</button>\n      </div>\n    </div>\n    <form class="form-card">\n      <label for="word" class="form-card__text">Word:</label>\n      <input id="word" class="form-card__input" name="word" type="text">\n      <label for="translation" class="form-card__text">Translation:</label>\n      <input id="translation" class="form-card__input" name="translation" type="text">\n      <div class="form__select-file"> \n        <label>Sound:</label>\n        <button>Select file</button>\n        <input type="file">\n      </div>\n      <div class="form__select-file"> \n        <label>Image:</label>\n        <button>Select file</button>\n        <input type="file">\n      </div>\n      <div class="admin-card__button-container">\n        <input type="button" class="form-card__cancel" value="Cancel">\n      </div>\n    </form>`}}},343:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Card=void 0;const s=i(891),n=i(952);i(76);const a="flipped",r="disabled-card",o="correcr-choice",d="card-play";t.Card=class{constructor(e){this.cardDatabase=e,this.element=document.createElement("div"),this.element.classList.add("card-container",a),this.element.innerHTML=`\n    <div class="card card-train">\n      <div class="card__side">\n        <div class="card__img" style="background-image: url('${n.C.SERVER_URL}${this.cardDatabase.image}')"></div>\n        <div class="card__info">\n          <p>${this.cardDatabase.translate}</p>\n        </div>\n      </div>\n      <div class="card__side card__back">\n        <div class="card__img card__back-img" style="background-image: \n        url('${n.C.SERVER_URL}${this.cardDatabase.image}')"></div>\n        <div class="card__info card__back-info">\n          <p class="word">${this.cardDatabase.word}</p>\n          <div class="card__toggle"></div>\n        </div>\n      </div>\n    </div>`}flipToBack(){this.element.classList.add(a)}getWorld(){var e;return null!==(e=this.element.getElementsByClassName("word")[0].textContent)&&void 0!==e?e:""}flipToFront(){this.element.classList.remove(a)}getCard(){return this.element.getElementsByClassName("card__back")[0]}getToggle(){return this.element.getElementsByClassName(n.C.CLASS_CARD_TOOGLE)[0]}setEnabled(){this.element.classList.remove(r)}setDisabled(){this.element.classList.add(r)}setListeners(){this.element.getElementsByClassName(n.C.CLASS_CARD_TOOGLE)[0].addEventListener(s.Events.click,(()=>this.flipToFront())),this.element.onmouseleave=()=>this.flipToBack()}setMode(e){e?(this.setDisabled(),this.element.classList.add(d)):(this.setEnabled(),this.element.classList.remove(d),this.element.classList.remove(o))}setCurrentChoice(){this.element.classList.add(r),this.element.classList.add(o)}}},465:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CategoryAdmin=void 0,t.CategoryAdmin=class{constructor(e,t){this.category=e,this.element=document.createElement("div"),this.element.classList.add("admin-card","admin-card-category"),this.element.innerHTML=` \n    <div class="admin-card__remove"></div>\n    <div class="about-category">\n      <p class="admin-card__title">${e.name}</p>\n      <p class="admin-card-category__text">WORDS: <span>${t}</span></p>\n      <div class="admin-card__button-container">\n        <button class="update-button">Update</button>\n        <button class="words-button">Words</button>\n      </div>\n    </div>\n    <form class="form-category">\n      <label for="name" class="form-category__text">Category Name:</label>\n      <input id="name" class="form-category__input" name="name" type="text">\n      <div class="admin-card__button-container">\n        <input type="button" class="form-category__cancel" value="Cancel">\n        <input type="submit" class="form-category__submit" value="Create">\n      </div>\n    </form>`}getRemove(){return this.element.getElementsByClassName("admin-card__remove")[0]}getUpdate(){return this.element.getElementsByClassName("update-button")[0]}getWords(){return this.element.getElementsByClassName("words-button")[0]}}},22:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Category=void 0;const s=i(952);i(278);const n="card-category-play",a="card-category-train";t.Category=class{constructor(e){this.category=e,this.element=document.createElement("div"),this.element.classList.add("category-container"),this.element.innerHTML=`\n    <a class="card-category ${a}" href="#cards">\n      <div class="card-category__image" style="background-image: url('${s.C.SERVER_URL}${e.image}')"></div>\n      <p class="card-category__name">${e.name}</p>\n    </a>`}setMode(e){e?this.element.getElementsByClassName(a)[0].classList.add(n):this.element.getElementsByClassName(a)[0].classList.remove(n)}getName(){var e,t;const i=null===(t=null===(e=this.element.querySelector("p"))||void 0===e?void 0:e.textContent)||void 0===t?void 0:t.replace(/ /g,"-").toLowerCase();return null!=i?i:""}}},0:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Footer=void 0,i(850),t.Footer=class{constructor(){this.element=document.createElement("footer"),this.element.classList.add("footer"),this.element.innerHTML='\n    <div class="footer__container"> \n      <a class="footer__github" href="https://github.com/rolling-scopes-school/mariacherkez-JSFE2021Q1">github</a>\n      <p>made in 2021</p>\n      <a class="footer__school" href="https://rs.school/js/"></a>\n    </div>'}}},977:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0,i(528);const s="train-button",n="play-button",a="text";t.Header=class{constructor(e){this.element=document.createElement("header"),this.element.classList.add("header"),this.isAdmin=e,this.update(e)}update(e){this.isAdmin=e,e?(this.element.classList.add("admin-header"),this.element.innerHTML='\n  <div class="admin-container">\n  <div class="admin-categories"><a href="#admin">Categories</a></div>\n  <div class="admin-words"><a href="#admin">Words</a></div>\n  <div class="buttin-logout">Log out</div>\n  </div>'):(this.element.classList.remove("admin-header"),this.element.innerHTML='\n  <div class="container">  \n    <div class="menu">\n      <div class="menu__burger"></div>\n    </div> \n    <div class="train-button">\n      <p class="text">train</p>\n      <div class="toggle-button"></div>\n    </div>\n  </div>\n  ')}getMenu(){return this.element.getElementsByClassName("menu")[0]}getModeButton(){return this.element.getElementsByClassName(s)[0]}toogleMode(){const e=this.element.getElementsByClassName(s)[0];e.classList.toggle(n),e.classList.contains(n)?e.getElementsByClassName(a)[0].textContent="play":e.getElementsByClassName(a)[0].textContent="train"}toogleMenu(){const e=this.getMenu();e&&e.classList.toggle("menu-open")}setOpenMenu(){const e=this.getMenu();e&&e.classList.remove("menu-open")}getLogOut(){return this.element.getElementsByClassName("buttin-logout")[0]}getLinkCategories(){return this.element.getElementsByClassName("admin-categories")[0]}getLinkWords(){return this.element.getElementsByClassName("admin-words")[0]}setSelect(e){this.isAdmin&&(e?(this.getLinkCategories().classList.remove("active-link"),this.getLinkWords().classList.add("active-link")):(this.getLinkCategories().classList.add("active-link"),this.getLinkWords().classList.remove("active-link")))}}},583:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function r(e){try{d(s.next(e))}catch(e){a(e)}}function o(e){try{d(s.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Main=void 0;const n=i(891),a=i(380),r=i(794),o=i(952),d=i(505),c=i(259),l=i(598),h=i(343),u=i(22),m=i(966),g=i(988);i(57);const p=`${o.C.SERVER_URL}/public/audio/correct.mp3`,v=`${o.C.SERVER_URL}/public/audio/error.mp3`,y=`${o.C.SERVER_URL}/public/audio/success.mp3`,f=`${o.C.SERVER_URL}/public/audio/failure.mp3`;t.Main=class{constructor(){this.categories=[],this.cards=[],this.element=document.createElement("main"),this.element.classList.add("main"),this.mainContainer=document.createElement("div"),this.mainContainer.classList.add("main-container"),this.element.append(this.mainContainer),this.currentRoute=r.Route.main,this.isPlay=!1,this.currentCategory="",this.statisticsPage=new g.StatisticsPage,this.adminPage=new l.AdminPage,this.statisticsPage.getReset().addEventListener(n.Events.click,this.resetStatisticsListener.bind(this)),this.statisticsPage.getRepeat().addEventListener(n.Events.click,this.RepeatWordsListener.bind(this))}setCurrentPage(e){return s(this,void 0,void 0,(function*(){e===r.Route.main?(this.currentRoute=r.Route.main,yield this.addCategories(),this.currentCategory="",this.updateMode()):e===r.Route.cards?(this.currentRoute=r.Route.cards,yield this.addCards(this.currentCategory),this.updateMode()):e===r.Route.statistics?(this.removeGame(),this.currentRoute=r.Route.statistics,this.statisticsPage.createTable(),this.currentCategory="",this.mainContainer.innerHTML="",this.mainContainer.append(this.statisticsPage.element)):e===r.Route.admin&&(this.removeGame(),this.currentRoute=r.Route.admin,this.currentCategory="",this.mainContainer.innerHTML="",this.mainContainer.append(this.adminPage.element))}))}addCategories(){return s(this,void 0,void 0,(function*(){this.categories=[];try{const e=yield c.getCategories();e.ok&&(yield e.json()).forEach((e=>{this.categories.push(new u.Category(e))}))}catch(e){console.log(e)}finally{this.mainContainer.innerHTML="",this.categories.forEach((e=>this.mainContainer.appendChild(e.element)))}}))}addCards(e){return s(this,void 0,void 0,(function*(){let t;this.cards=[];try{if(e===o.C.DIFFICULT_CATEGORY)t=yield c.getDifficultCards();else{const i=yield c.getCardsByCategory(e);i.ok&&(t=yield i.json())}0===t.length?this.mainContainer.innerHTML="<div>There are no words..</div>":this.cards=t.map((e=>new h.Card(e)))}catch(e){console.log(e)}finally{this.mainContainer.innerHTML="",this.cards.forEach((e=>this.mainContainer.appendChild(e.element)))}}))}updateMode(){this.currentRoute===r.Route.main?this.categories.forEach((e=>{e.setMode(this.isPlay),e.element.onclick=()=>{this.currentCategory=e.category._id}})):this.currentRoute===r.Route.cards&&(this.isPlay&&this.currentCategory&&this.cards.length>0?(this.game=new a.Game(this.cards),this.game.button.onclick=this.startGame.bind(this),this.element.append(this.game.button,this.game.score)):this.removeGame(),this.cards.forEach((e=>{e.setListeners(),e.setMode(this.isPlay),e.getCard().addEventListener(n.Events.click,this.cardClickListener.bind(this,e))})))}removeGame(){var e,t;this.game=void 0,null===(e=this.element.querySelector(".button-start"))||void 0===e||e.remove(),null===(t=this.element.querySelector(".score-container"))||void 0===t||t.remove()}toogleMode(){this.isPlay=!this.isPlay,this.updateMode()}adminCategory(){this.adminPage.currentCategory="",this.adminPage.setCurrentPage()}startGame(){this.currentRoute===r.Route.cards&&(this.cards.sort((()=>Math.random()-.5)),this.mainContainer.innerHTML="",this.cards.forEach((e=>this.mainContainer.appendChild(e.element))),this.cards.forEach((e=>e.setEnabled())),this.game&&(this.game.setRepeatButton(),this.game.button.onclick=()=>this.playAudio(this.getCurrentAudio()),this.playAudio(this.getCurrentAudio())))}getCurrentAudio(){var e;return`${o.C.SERVER_URL}${null===(e=this.game)||void 0===e?void 0:e.getCurrentAudio()}`}playAudio(e){this.audio=new Audio(`${e}`),this.audio.play(),this.game&&(this.audio.addEventListener(n.Events.pause,(()=>this.cards.forEach((e=>{e.element.classList.contains("correcr-choice")||e.setEnabled()})))),this.audio.addEventListener(n.Events.play,(()=>this.cards.forEach((e=>e.setDisabled())))))}checkEndGame(){return s(this,void 0,void 0,(function*(){if(this.game)if(this.game.indexAudio===this.game.audio.length-1){this.currentRoute=r.Route.main;const e=0===this.game.errors,t=new m.ResultPage(e,this.game.errors);this.mainContainer.innerHTML="",this.mainContainer.append(t.element),this.removeGame(),e?this.playAudio(y):this.playAudio(f),yield d.delay(3e3),window.history.pushState(null,"",`#${r.Route.main}`),window.dispatchEvent(new HashChangeEvent(n.Events.hashchange))}else this.game.indexAudio++,this.playAudio(this.getCurrentAudio())}))}RepeatWordsListener(){return s(this,void 0,void 0,(function*(){this.currentCategory=o.C.DIFFICULT_CATEGORY,window.history.pushState(null,"",`#${r.Route.cards}`),window.dispatchEvent(new HashChangeEvent(n.Events.hashchange))}))}resetStatisticsListener(){return s(this,void 0,void 0,(function*(){yield c.clearStatistics(),this.statisticsPage.createTable()}))}cardGameClickListener(e){return s(this,void 0,void 0,(function*(){if(this.game)if(this.game.audio[this.game.indexAudio]===e.cardDatabase.audio){try{const t=yield c.getStatisticsByCard(e.cardDatabase._id);if(t.ok){const e=yield t.json();e.correct++,yield c.updateStatistics(e)}}catch(e){console.log(e)}e.setCurrentChoice(),this.playAudio(p),this.game.addStar(!0),this.checkEndGame()}else{try{const t=yield c.getStatisticsByCard(e.cardDatabase._id);if(t.ok){const e=yield t.json();e.error++,yield c.updateStatistics(e)}}catch(e){console.log(e)}this.game.errors++,this.playAudio(v),this.game.addStar(!1)}}))}cardClickListener(e,t){return s(this,void 0,void 0,(function*(){if(this.isPlay)e.element.onclick=this.cardGameClickListener.bind(this,e);else if(t.target instanceof HTMLElement&&!t.target.classList.contains(o.C.CLASS_CARD_TOOGLE)){this.playAudio(`${o.C.SERVER_URL}${e.cardDatabase.audio}`);try{const t=yield c.getStatisticsByCard(e.cardDatabase._id);if(t.ok){const e=yield t.json();e.train++,yield c.updateStatistics(e)}}catch(e){console.log(e)}}}))}}},53:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Popup=void 0,i(667);const s="popup-button-cancel",n="popup-button-submit",a="highlight";t.Popup=class{constructor(){var e;this.element=document.createElement("div"),this.element.classList.add("popup"),this.element.innerHTML=`\n    <form>\n    <div class="popup-container"> \n        <p>login</p>\n        <div class="popup-fields">\n          <label for="name" id="label-name">login\n          <input id="name" name="name" type="text"></label>\n          <label for="password" id="label-password">password\n          <input  id="password" name="password" type="password"></label>\n        </div>\n        <div class="popup-button-container">\n          <button class="popup-button ${s}">cancel</button>\n          <input class="popup-button ${n}" type="submit" value="login">\n        </div>\n    </div>\n    </form>`,null===(e=this.element.querySelector("form"))||void 0===e||e.addEventListener("input",this.unHighlight.bind(this)),this.getCancel().addEventListener("click",this.cancelListener.bind(this))}clearPopup(){const e=this.element.querySelector("#name"),t=this.element.querySelector("#password");e instanceof HTMLInputElement&&t instanceof HTMLInputElement&&(e.value="",t.value="",this.unHighlight())}openPopup(){this.element.style.display="block"}closePopup(){this.clearPopup(),this.element.style.display="none"}getName(){const e=this.element.querySelector("#name");return e instanceof HTMLInputElement?e.value:""}getPass(){const e=this.element.querySelector("#password");return e instanceof HTMLInputElement?e.value:""}getCancel(){return this.element.getElementsByClassName(s)[0]}getSubmit(){return this.element.getElementsByClassName(n)[0]}cancelListener(e){e.preventDefault(),this.closePopup()}highlight(){const e=this.element.querySelector("#password"),t=this.element.querySelector("#label-password"),i=this.element.querySelector("#name"),s=this.element.querySelector("#label-name");e instanceof HTMLInputElement&&(e.value||(e.classList.add(a),null==t||t.classList.add(a))),i instanceof HTMLInputElement&&(i.value||(i.classList.add(a),null==s||s.classList.add(a)))}unHighlight(){this.element.querySelectorAll(".highlight").forEach((e=>e.classList.remove(a)))}checkFields(){return!!this.getName()&&!!this.getPass()}}},966:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResultPage=void 0,i(693),t.ResultPage=class{constructor(e,t){this.element=document.createElement("div"),this.element.classList.add("result-container");const i=e?"result-success-img":"result-failure-img",s=e?"Win!":`Errors ${t}`;this.element.innerHTML=`\n    <p class="result-text">${s}</p>\n    <div class="result-img ${i}"></div>\n    `}}},695:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function r(e){try{d(s.next(e))}catch(e){a(e)}}function o(e){try{d(s.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Sidebar=void 0;const n=i(259);i(371);const a="active-link";t.Sidebar=class{constructor(){this.element=document.createElement("aside"),this.element.classList.add("aside"),this.element.innerHTML='\n    <nav>\n    <ul class="aside-menu">\n    </ul>\n    </nav>\n    <button class="login-button">login</button>\n    '}getLoginButton(){return this.element.getElementsByClassName("login-button")[0]}addLinks(){return s(this,void 0,void 0,(function*(){const e=this.element.getElementsByClassName("aside-menu")[0];e.innerHTML="";const t=document.createElement("li");t.innerHTML='<a href="#" class="active-link">Main Page</a>',e.append(t);try{const t=yield n.getCategories();t.ok&&(yield t.json()).forEach((t=>{const i=document.createElement("li"),s=document.createElement("a");s.setAttribute("href","#cards"),s.setAttribute("data-cat",`${t._id}`),s.innerHTML=`${t.name}`,i.append(s),e.append(i)}))}catch(e){console.log(e)}const i=document.createElement("li");i.innerHTML='<a href="#statistics">Statistics</a>',e.append(i)}))}getLinks(){return this.element.querySelectorAll("a")}toogleMode(){this.element.classList.toggle("status-play")}toggleSidebar(){this.element.classList.toggle("aside-open")}closeSidebar(){this.element.classList.remove("aside-open")}setCurrent(e,t){this.getLinks().forEach((i=>{t&&i.dataset.cat===t?i.classList.add(a):t||i.getAttribute("href")!==`#${e}`?i.classList.remove(a):i.classList.add(a)}))}}},988:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function r(e){try{d(s.next(e))}catch(e){a(e)}}function o(e){try{d(s.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StatisticsPage=void 0;const n=i(891),a=i(732),r=i(505),o=i(259);var d,c;i(642),function(e){e.asc="asc",e.desc="desc"}(d||(d={})),function(e){e[e.word=0]="word",e[e.translation=1]="translation",e[e.category=2]="category",e[e.clicks=3]="clicks",e[e.correct=4]="correct",e[e.wrong=5]="wrong",e[e.percent=6]="percent"}(c||(c={}));const l="sort-desc",h="sort-asc";t.StatisticsPage=class{constructor(){var e;this.element=document.createElement("div"),this.element.classList.add("statistics"),this.data=[],this.sortType=d.asc,this.sortColumn=c.word,this.element.innerHTML=`\n    <div class="statistics__button-container">\n    <button class="statistics__button repeat-button">Repeat difficult words</button>\n    <button class="statistics__button reset-button">Reset</button>\n    </div>\n    <div class="table-container">\n    <table class="table">\n    <tr class="table__row table__row_head">\n      <th data-sort="${c.word}">Word</th>\n      <th data-sort="${c.translation}">Translation</th>\n      <th data-sort="${c.category}">Category</th>\n      <th data-sort="${c.clicks}">Clicks</th>\n      <th data-sort="${c.correct}">Correct</th>\n      <th data-sort="${c.wrong}">Wrong</th>\n      <th data-sort="${c.percent}">% errors</th>\n    </tr>\n    </table>\n    </div>\n    `,null===(e=this.element.querySelector(".table"))||void 0===e||e.addEventListener(n.Events.click,this.tableClickListener.bind(this))}getReset(){return this.element.getElementsByClassName("reset-button")[0]}getRepeat(){return this.element.getElementsByClassName("repeat-button")[0]}tableClickListener(e){var t,i;e.target instanceof HTMLElement&&e.target.dataset.sort&&(null===(t=this.element.querySelector(".sort-desc"))||void 0===t||t.classList.remove(l),null===(i=this.element.querySelector(".sort-asc"))||void 0===i||i.classList.remove(h),this.sortColumn.toString()!==e.target.dataset.sort?(this.sortColumn=parseInt(e.target.dataset.sort,10),this.sortType=d.asc):this.sortType===d.asc?this.sortType=d.desc:this.sortType=d.asc,this.sortType===d.asc?e.target.classList.add(h):e.target.classList.add(l),this.updateTable())}createTable(){return s(this,void 0,void 0,(function*(){this.data=[];let e=[],t=[],i=[];try{const s=yield o.getCategories();s.ok&&(e=yield s.json());const n=yield o.getCards();n.ok&&(t=yield n.json());const a=yield o.getStatistics();a.ok&&(i=yield a.json())}catch(e){console.log(e)}t.forEach((t=>{const s=e.findIndex((e=>e._id===t.categoryId.toString()));if(-1!==s){const n=e[s],r=i.findIndex((e=>e.cardId===t._id));if(-1!==r){const e=i[r];this.data.push(new a.StatisticsData(t._id,n.name,t.word,t.translate,e.train,e.correct,e.error))}}})),this.updateTable()}))}sortData(){switch(this.sortColumn){case c.translation:this.data.sort(((e,t)=>this.sortType===d.asc?r.compare(e.translate,t.translate):r.compare(t.translate,e.translate)));break;case c.category:this.data.sort(((e,t)=>this.sortType===d.asc?r.compare(e.categoryName,t.categoryName):r.compare(t.categoryName,e.categoryName)));break;case c.clicks:this.data.sort(((e,t)=>this.sortType===d.asc?e.train-t.train:t.train-e.train));break;case c.correct:this.data.sort(((e,t)=>this.sortType===d.asc?e.correct-t.correct:t.correct-e.correct));break;case c.wrong:this.data.sort(((e,t)=>this.sortType===d.asc?e.error-t.error:t.error-e.error));break;case c.percent:this.data.sort(((e,t)=>this.sortType===d.asc?r.getPercent(e)-r.getPercent(t):r.getPercent(t)-r.getPercent(e)));break;default:this.data.sort(((e,t)=>this.sortType===d.asc?r.compare(e.word,t.word):r.compare(t.word,e.word)))}}updateTable(){this.sortData();const e=this.element.querySelector(".table");if(e instanceof HTMLTableElement)for(;e.rows.length>1;)e.deleteRow(e.rows.length-1);e instanceof HTMLTableElement&&this.data.forEach((t=>{const i=e.insertRow();i.classList.add("table__row");const s=i.insertCell(0),n=i.insertCell(1),a=i.insertCell(2),o=i.insertCell(3),d=i.insertCell(4),c=i.insertCell(5),l=i.insertCell(6);s.innerHTML=t.word,n.innerHTML=t.translate,a.innerHTML=t.categoryName,o.innerHTML=t.train.toString(),d.innerHTML=t.correct.toString(),c.innerHTML=t.error.toString(),l.innerHTML=r.getPercent(t).toFixed(2)}))}}},259:function(e,t,i){var s=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))((function(n,a){function r(e){try{d(s.next(e))}catch(e){a(e)}}function o(e){try{d(s.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}d((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCardsByCategory=t.deleteCategory=t.updateStatistics=t.getStatisticsByCard=t.clearStatistics=t.getDifficultCards=t.getStatistics=t.getCards=t.getCardsByCategory=t.getCategoryById=t.getCategories=void 0;const n=i(952);t.getCategories=()=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/categories`)})),t.getCategoryById=e=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/categories?id=${e}`)})),t.getCardsByCategory=e=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/cards?categoryId=${e}`)})),t.getCards=()=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/cards`)})),t.getStatistics=()=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/statistics`)})),t.getDifficultCards=()=>s(void 0,void 0,void 0,(function*(){let e=[],t=[];const i=yield fetch(`${n.C.SERVER_URL}/api/statistics`);if(i.ok){e=yield i.json(),e=e.filter((e=>0!==e.error)),e=e.sort(((e,t)=>t.error-e.error)).slice(0,8);const s=yield fetch(`${n.C.SERVER_URL}/api/cards`);s.ok&&(t=yield s.json(),t=t.filter((t=>-1!==e.findIndex((e=>e.cardId===t._id)))))}return t})),t.clearStatistics=()=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/statistics`,{method:"DELETE"})})),t.getStatisticsByCard=e=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/statistics?cardId=${e}`)})),t.updateStatistics=e=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/statistics`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})})),t.deleteCategory=e=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/categories?id=${e}`,{method:"DELETE"})})),t.deleteCardsByCategory=e=>s(void 0,void 0,void 0,(function*(){return yield fetch(`${n.C.SERVER_URL}/api/cards?categoryId=${e}`,{method:"DELETE"})}))}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var a=t[s]={exports:{}};return e[s].call(a.exports,a,a.exports,i),a.exports}i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{i(503),i(948),i(373);const e=i(752);window.onload=()=>{(new e.App).entryPage()}})()})();